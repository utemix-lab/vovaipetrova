# Vovaipetrova

Интерактивная 3D-визуализация онтологического графа с pointer-tags навигацией.

## Vision: Dual‑use UI (Human + Agent)

Мы проектируем профессиональный интерфейс для работы с онтологическими графами и системами.

- Сейчас: интерфейс для людей (дизайнеры, архитекторы, разработчики) — красивый, плавный, с анимациями.
- Будущее: тот же интерфейс с программной доступностью для ИИ‑агентов, анализирующих код.

Фокус на UX сегодня, но архитектура закладывается так, чтобы каждый UI‑паттерн был предсказуемым и адресуемым как часть будущего API.
Анимации трактуем как прототипы будущих агентных взаимодействий.

## Architecture Instruction: Meta‑React for Code

Мы строим не приложение, а Meta‑React для кода: система управляет состоянием **замысла** в кодовой базе.

**Поток:** Код → Онтологический граф → Рефлексия → Самокоррекция → Код.

**Архитектурный контекст в коде:** `render/src/architecture-context.ts`.
**Контекст для IDE-агента:** `.agent-context.md`.
**Архитектурные якоря (DNA):** `render/src/architecture/dna.ts`.
**Агентный YAML-контекст:** `.agent/context.yml`.

**Слойная аналогия (без пафоса):**

- Реальный код = DOM.
- AST + граф зависимостей = Virtual DOM.
- Онтологический граф = State + компонентная иерархия.
- Слой связывания + агентный движок = Reconciliation.
- LLM + RAG = Hooks/Effects.
- Единый источник истины = онтологический граф + зависимости.

**Практические выводы:**

- UI‑фреймворк необязателен: можно использовать Vanilla JS или React по задаче.
- Поток данных — однонаправленный: онтология → код, не наоборот.
- Трансформации должны быть предсказуемыми (как pure functions).
- Обновления должны быть дифф‑ориентированными, чтобы не переписывать всё.

## React Benefits (2 уровня)

**Уровень 1 — немедленный (UX):**

- Сложные анимации виджетов проще реализовывать через Framer Motion.
- Переходы между состояниями становятся декларативными, а не императивными.
- Управление сложным UI — через компоненты вместо ручного DOM.

**Уровень 2 — стратегический (архитектура):**

- Декларативное мышление тренирует будущий онтологический слой.
- Компонентная архитектура отражает онтологические модули.
- Реактивность и состояние = прототип гомеостаза системы.

**React как тренажёр (параллели):**

- Декларативность: описываем «что должно быть», а не «как изменить DOM».
- Состояние как источник истины: онтологический граф — аналог state.
- Эффекты: реакции на изменения состояния — аналог агентных действий.
- Композиция: сборка модулей из смысловых компонентов.

## React Risks & Mitigations (structure)

### Риск 1: React как отвлечение

- Использовать React только для сложных анимаций и прототипов архитектурных паттернов.
- Не переписывать простые части без необходимости.

### Риск 2: Слишком сложно учить

- Начать с базовых 20%: `useState`, `useEffect`, компоненты/пропсы, основы Framer Motion.
- Остальное добавлять по мере потребности.

### Риск 3: Завязнуть в экосистеме

- Держать фокус: React — инструмент, а не цель.
- Каждый React‑паттерн переводить в урок для будущей системы.
- Обязательная фиксация инсайтов.

**Двойной фокус при разработке:**

- Уровень 1: «Как сделать UX‑анимацию/переход?»
- Уровень 2: «Как этот паттерн перенести на онтологию/код?»

## Refactor Plan

См. `docs/REFACTOR_PLAN.md` — фиксированная дорожная карта React + GraphEngine.

## Refactor Execution

См. `docs/REFACTOR_EXECUTION_PLAN.md` — пошаговый план, обязательный для агента.

## Agent Recovery Guide

См. `docs/AGENT_RECOVERY.md` — инструкция на случай сбоя/смены сессии.

## Agent Task Template

См. `docs/AGENT_TASK_TEMPLATE.md` — шаблон начала каждого задания для IDE‑агента.

## Важно: облегчённый рендер

Этот репозиторий — облегчённая и пересобранная версия рендера из:

- r:\dream-graph (рендер и визуальный стиль)
- r:\contracts (UI-контракты + правила UI)
- r:\extended-mind (архитектурные и нарративные основания)

Если чего-то не хватает для работы или понимания — сначала смотрим в эти репозитории.
Важное переносим в этот репо и поддерживаем инженерный порядок.

## Live Demo

<https://utemix-lab.github.io/vovaipetrova/>

## Development

```bash
npm install
cd render && npm install
npm run dev
```

Фоновый запуск (не падает при запуске других команд в терминале):

```bash
npm run dev:daemon
```

Остановить фоновый процесс:

```bash
npm run dev:stop
```

Служба Windows (автозапуск и автоперезапуск):

```bash
npm run service:install
```

Удаление службы:

```bash
npm run service:remove
```

Открыть: <http://localhost:5173/vovaipetrova/>
Диагностика самовосстановления: `logs/diagnostics.log`.

## Build & Deploy

```bash
npm run build      # Сборка в render/dist/
git push origin main  # Автодеплой на GitHub Pages
```

## UI Rules: быстрые и полные проверки

Механика UI зафиксирована двумя уровнями:

- `render/public/ui/UI_RULES.md` — человеческие правила.
- `render/public/ui/ui-rules.json` — машинные инварианты для быстрых проверок.

Быстрый режим (без сборки):

```bash
npm run check:fast
```

Полный режим (включая сборку рендера):

```bash
npm run check:full
```

### Визуальные снимки (селективные)

Снимки берутся только по ключевым состояниям, чтобы не утяжелять каждую проверку.

Запуск сравнения:

```bash
npm run check:visual
```

Обновление базовых снимков (при осознанных визуальных правках):

```bash
npm run check:visual:update
```

## Структура репо

```text
vovaipetrova/
├── core/                   # Валидация схем (невебовая логика)
│   └── validate.js
│
├── render/                 # Vite-приложение
│   ├── public/             # Статика (коммитится в git)
│   │   ├── assets/         # Иконки, фоны, аватары
│   │   ├── graph/          # universe.json — данные графа
│   │   ├── exports/        # Реестры (pointer_tags, ai_catalog)
│   │   ├── routes/         # Маршруты сессий
│   │   └── ui/             # UI-контракты и правила (единый канон механики)
│   ├── src/
│   │   ├── scenes/         # Сцены визуализации
│   │   │   ├── visitor.js  # Основная сцена
│   │   │   ├── system.js   # Системный граф
│   │   │   └── _archive/   # Legacy-код (резерв)
│   │   ├── compat/         # Совместимость путей
│   │   └── visual/         # Визуальные конфиги
│   └── vite.config.js
│
└── tests/                  # Тесты валидации
```

## Машинный ориентир (быстрое понимание)

- `render/public/ui/UI_RULES.md` — единый канон механики UI.
- `render/public/ui/**` — контрактные данные UI (layout/bindings/interaction/widgets).
- `render/src/**` — реализация рендера и визуальных правил.
- `MACHINE_CONTEXT.md` — краткий машинный контекст репозитория.
- Существенные сдвиги оформлять через PR с 4‑секционным описанием; мелкие фиксы допускаются прямыми коммитами.

## Ключевые концепции

- **Pointer-tags** — теги для ситуативной навигации (`cap:lipsync`, `method:rag`)
- **Routes** — маршруты/сессии для guided-навигации
- **Exports** — реестры и каталоги (AI, практики, сигналы)

## TODO (заделы на будущее)

- [ ] Ситуативная выдача pointer-tags на основе контекста
- [ ] LLM/Agent интеграция для intent detection
- [ ] Session persistence между визитами
