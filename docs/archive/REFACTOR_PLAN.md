# Refactor Plan (React + GraphEngine)

Этот документ фиксирует замысел рефакторинга, чтобы он не оставался чисто нарративным.

## Цели

- Обернуть текущий Three.js граф в React‑компоненты без потери функционала.
- Вынести графовую физику в абстрактный `GraphEngine`.
- Перевести UI‑панели в декларативные React‑компоненты.
- Синхронизировать 3D и UI через единый state.
- Добавить управляемые анимации через Framer Motion.

## Этапы (без сроков)

### Этап A — React + Three.js интеграция

- Создать React‑оболочку вокруг существующего графа.
- Сохранить текущий набор событий и состояния.
- Использовать рефы/хуки для безопасного управления Three.js.

### Этап B — GraphEngine абстракция

- Определить интерфейс `IGraphEngine` (инициализация, данные, события, фокус).
- Реализовать `ThreeGraphEngine` на основе текущего кода `visitor.js`.
- Подготовить возможность замены движка.

### Этап C — UI‑слой в React

- Перевести панели и оверлеи в React‑компоненты.
- Отказаться от ручного DOM‑управления в пользу state/props.
- Синхронизировать состояние графа и UI через единый store.

### Этап D — Анимации и переходы

- Включить Framer Motion для переходов сцен/виджетов.
- Устранить ручные императивные анимации.
- Поддержать анимации как прототипы агентных состояний.

## Принципы

- Three.js остаётся физическим ядром, React — слой управления.
- Коммуникация через state, а не через отдельные JSON‑файлы.
- Нужна поддержка нескольких «фокусов» (структурный / онтологический / временной).
- Каждый React‑паттерн должен быть переносим на будущую мета‑систему.
