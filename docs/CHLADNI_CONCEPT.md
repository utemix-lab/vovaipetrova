# Chladni Simulation — Концепция механики VSTablichment

**Дата:** 17 февраля 2026
**Статус:** Прототип реализован

## Суть

Симуляция фигур Хладни — визуализация резонансных паттернов, возникающих на вибрирующей пластине. Частицы (песок) стремятся к узловым линиям — местам, где амплитуда колебаний равна нулю.

## Формула

Для квадратной пластины со стороной L:

```
f(x,y) = cos(n*π*x/L) * cos(m*π*y/L) - cos(m*π*x/L) * cos(n*π*y/L)
```

Параметры `m` и `n` определяют форму паттерна. При `m ≠ n` возникают характерные фигуры.

## Режимы работы

### Idle (фоновое состояние)
- Частицы образуют плавное облако
- Броуновское движение с мягким притяжением к центру
- Нет жёстких границ — облако "дышит"
- Визуально напоминает туманность или звёздное скопление

### Pattern (резонанс)
- Активируется по клику кнопки "Резонанс"
- Частицы стремятся к узловым линиям паттерна
- Формируется характерная фигура Хладни
- Длительность: ~5 секунд
- После — автоматический возврат в idle

## Интеграция в UI

- **Расположение:** Левая часть narrative-screen (shape-area)
- **Формат:** Квадратный canvas с прозрачным фоном
- **Цвет частиц:** Белый (#ffffff)
- **Фон:** Прозрачный, накладывается на фоновый ассет

## Файлы

| Файл | Описание |
|------|----------|
| `render/src/effects/ChladniSimulation.js` | Класс симуляции |
| `render/src/scenes/visitor.js` | Интеграция в VSTablichment |
| `render/src/scenes/visitor.css` | Стили canvas и кнопки |

## API ChladniSimulation

```javascript
const sim = new ChladniSimulation(canvas, {
  particleCount: 2000,      // Количество частиц
  particleColor: "#ffffff", // Цвет
  speed: 0.5,               // Скорость движения к паттерну
  friction: 0.94,           // Трение (0-1)
  m: 3, n: 5,               // Начальный паттерн
  patternDuration: 5000     // Длительность паттерна (мс)
});

sim.start();           // Запуск в режиме idle
sim.triggerPattern();  // Активация случайного паттерна
sim.setPattern(m, n);  // Установка конкретного паттерна
sim.stop();            // Остановка
sim.destroy();         // Очистка ресурсов
```

## Будущее развитие

1. **Звуковая синхронизация** — паттерны меняются в ответ на аудио-анализ
2. **Интерактивные паттерны** — пользователь выбирает m/n через UI
3. **Связь с VST-категориями** — каждая категория = свой паттерн
4. **Анимация перехода** — плавная морфинг между паттернами
5. **Цветовые схемы** — паттерны разных цветов для разных состояний

## Референсы

- [Ernst Chladni](https://en.wikipedia.org/wiki/Ernst_Chladni) — первооткрыватель
- [Paul Bourke — Chladni Plates](http://paulbourke.net/geometry/chladni/) — математика
- Собственная реализация на Canvas без внешних зависимостей

## Архитектурная связь

- **Track 4 (Projection/UI)** — визуальный эффект
- **VSTablichment workbench** — контекст использования
- **Будущее:** интеграция с аудио-движком для реального резонанса
